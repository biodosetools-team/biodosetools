<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dicentrics dose-effect fitting • biodosetools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Nunito-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Dicentrics dose-effect fitting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biodosetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Dicentrics</h6></li>
    <li><a class="dropdown-item" href="../articles/dicent-fitting.html">Dicentrics dose-effect fitting</a></li>
    <li><a class="dropdown-item" href="../articles/dicent-estimation.html">Dicentrics dose estimation</a></li>
    <li><a class="dropdown-item" href="../articles/dicent-limits.html">Dicentrics characteristic limits</a></li>
    <li><a class="dropdown-item" href="../articles/dicent-mixed.html">Dicentrics dose estimation criticality accidents</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Translocations</h6></li>
    <li><a class="dropdown-item" href="../articles/trans-fitting.html">Translocations dose-effect fitting</a></li>
    <li><a class="dropdown-item" href="../articles/trans-estimation.html">Translocations dose estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Micronuclei</h6></li>
    <li><a class="dropdown-item" href="../articles/micro-fitting.html">Micronuclei dose-effect fitting</a></li>
    <li><a class="dropdown-item" href="../articles/micro-estimation.html">Micronuclei dose estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interlaboratory comparisons</h6></li>
    <li><a class="dropdown-item" href="../articles/interlab.html">Interlaboratory comparison</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biodosetools-team/biodosetools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Dicentrics dose-effect fitting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biodosetools-team/biodosetools/blob/main/vignettes/dicent-fitting.Rmd" class="external-link"><code>vignettes/dicent-fitting.Rmd</code></a></small>
      <div class="d-none name"><code>dicent-fitting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="input-count-data">Input count data<a class="anchor" aria-label="anchor" href="#input-count-data"></a>
</h2>
<p>The first step is to input the count data. On the {shiny} app, we can
select to either load the count data from a file (supported formats are
<code>.csv</code>, <code>.dat</code>, and <code>.txt</code>) or to input
the data manually. Once the table is generated and filled, the
“Calculate parameters” button will calculate the total number of cells
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>),
total number of aberrations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>),
as well as mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>y</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{y}</annotation></semantics></math>),
variance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^{2}</annotation></semantics></math>),
dispersion index
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>/</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\sigma^{2}/\bar{y}</annotation></semantics></math>),
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>-value.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-01.png" alt="'Data input options' and 'Fitting options' boxes in the dose-effect fitting module" width="100%"><p class="caption">
‘Data input options’ and ‘Fitting options’ boxes in the dose-effect
fitting module
</p>
</div>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-03.png" alt="'Data input' box in the dose-effect fitting module" width="75%"><p class="caption">
‘Data input’ box in the dose-effect fitting module
</p>
</div>
<p>This step is accomplished in R by calling the
<code><a href="../reference/calculate_aberr_table.html">calculate_aberr_table()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"count-data-barquinero-1995.csv"</span>, package <span class="op">=</span> <span class="st">"biodosetools"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate_aberr_table.html">calculate_aberr_table</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 13</span></span></span>
<span><span class="co">#&gt;        D     N     X    C0    C1    C2    C3    C4    C5    mean     var    DI</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0     <span style="text-decoration: underline;">5</span>000     8  <span style="text-decoration: underline;">4</span>992     8     0     0     0     0 0.001<span style="text-decoration: underline;">6</span>  0.001<span style="text-decoration: underline;">60</span> 0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.1   <span style="text-decoration: underline;">5</span>002    14  <span style="text-decoration: underline;">4</span>988    14     0     0     0     0 0.002<span style="text-decoration: underline;">80</span> 0.002<span style="text-decoration: underline;">79</span> 0.997</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  0.25  <span style="text-decoration: underline;">2</span>008    22  <span style="text-decoration: underline;">1</span>987    20     1     0     0     0 0.011<span style="text-decoration: underline;">0</span>  0.011<span style="text-decoration: underline;">8</span>  1.08 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  0.5   <span style="text-decoration: underline;">2</span>002    55  <span style="text-decoration: underline;">1</span>947    55     0     0     0     0 0.027<span style="text-decoration: underline;">5</span>  0.026<span style="text-decoration: underline;">7</span>  0.973</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  0.75  <span style="text-decoration: underline;">1</span>832   100  <span style="text-decoration: underline;">1</span>736    92     4     0     0     0 0.054<span style="text-decoration: underline;">6</span>  0.056<span style="text-decoration: underline;">0</span>  1.03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1     <span style="text-decoration: underline;">1</span>168   109  <span style="text-decoration: underline;">1</span>064    99     5     0     0     0 0.093<span style="text-decoration: underline;">3</span>  0.093<span style="text-decoration: underline;">3</span>  0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  1.5    562   100   474    76    12     0     0     0 0.178   0.189   1.06 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2      333   103   251    63    17     2     0     0 0.309   0.353   1.14 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3      193   108   104    72    15     2     0     0 0.560   0.466   0.834</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  4      103   103    35    41    21     4     2     0 1       0.882   0.882</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  5       59   107    11    19    11     9     6     3 1.81    2.09    1.15 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: u &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="irradiation-conditions">Irradiation conditions<a class="anchor" aria-label="anchor" href="#irradiation-conditions"></a>
</h2>
<p>Because irradiation conditions during calibration may influence
future dose estimates, and for a better traceability, the user can input
the conditions under which the samples used to construct the curve were
irradiated. This option is only available in the Shiny app, so that
these can be saved into the generated reports.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-02.png" alt="'Irradiation conditions' box in the dose-effect fitting module" width="100%"><p class="caption">
‘Irradiation conditions’ box in the dose-effect fitting module
</p>
</div>
</div>
<div class="section level2">
<h2 id="perform-fitting">Perform fitting<a class="anchor" aria-label="anchor" href="#perform-fitting"></a>
</h2>
<p>To perform the fitting the user needs to select the appropriate
fitting options to click the “Calculate fitting” button on the “Data
input” box.</p>
<p>The fitting results and summary statistics are shown in the “Results”
tabbed box, and the dose-effect curve is displayed in the “Curve plot”
box.</p>
<p>The “Export results” box shows two buttons: (a) “Save fitting data”,
and (b) “Download report”. The “Save fitting data” will generate an
<code>.rds</code> file that contains all information about the count
data, irradiation conditions, and options selected when performing the
fitting. This file can be then loaded in the dose estimation module to
load the dose-effect curve coefficients.</p>
<p>Similarly, the “Download report” will generate a <code>.pdf</code> or
a <code>.docx</code> report containing all inputs and fitting
results.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-04.png" alt="'Results' tabbed box, 'Curve plot' and 'Export results' boxes in the dose-effect fitting module" width="100%"><p class="caption">
‘Results’ tabbed box, ‘Curve plot’ and ‘Export results’ boxes in the
dose-effect fitting module
</p>
</div>
<p>To perform the fitting in R we call the <code><a href="../reference/fit.html">fit()</a></code>
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span></span>
<span>  count_data <span class="op">=</span> <span class="va">count_data</span>,</span>
<span>  model_formula <span class="op">=</span> <span class="st">"lin-quad"</span>,</span>
<span>  model_family <span class="op">=</span> <span class="st">"automatic"</span>,</span>
<span>  fit_link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  aberr_module <span class="op">=</span> <span class="st">"dicentrics"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>fit_results</code> object is a list that contains all
necessary information about the count data as well as options selected
when performing the fitting. This is a vital step to ensure traceability
and reproducibility. Below we can see its elements:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_results</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "fit_raw_data"         "fit_formula_raw"      "fit_formula_tex"     </span></span>
<span><span class="co">#&gt;  [4] "fit_coeffs"           "fit_cor_mat"          "fit_var_cov_mat"     </span></span>
<span><span class="co">#&gt;  [7] "fit_dispersion"       "fit_model_statistics" "fit_algorithm"       </span></span>
<span><span class="co">#&gt; [10] "fit_model_summary"</span></span></code></pre></div>
<p>In particular, we can see how <code>fit_coeffs</code> matches the
results obtained in the UI:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_results</span><span class="op">$</span><span class="va">fit_coeffs</span></span>
<span><span class="co">#&gt;                estimate    std.error statistic      p.value</span></span>
<span><span class="co">#&gt; coeff_C     0.001280319 0.0004714055  2.715961 6.608367e-03</span></span>
<span><span class="co">#&gt; coeff_alpha 0.021038724 0.0051576170  4.079156 4.519949e-05</span></span>
<span><span class="co">#&gt; coeff_beta  0.063032534 0.0040073856 15.729091 9.557291e-56</span></span></code></pre></div>
<p>To visualise the dose-effect curve, we call the
<code><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_results</span>,</span>
<span>  aberr_name <span class="op">=</span> <span class="st">"Dicentrics"</span>,</span>
<span>  place <span class="op">=</span> <span class="st">"UI"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="dicent-fitting_files/figure-html/dic-fit-dose-curve-1.png" alt="Plot of dose-effect curve generated by \{biodosetools\}. The grey shading indicates the uncertainties associated with the calibration curve." width="576"><p class="caption">
Plot of dose-effect curve generated by {biodosetools}. The grey shading
indicates the uncertainties associated with the calibration curve.
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://aldomann.com" class="external-link">Alfredo Hernández</a>, <a href="https://portalrecerca.uab.cat/es/persons/anna-frances-abellan" class="external-link">Anna Frances-Abellan</a>, David Endesfelder, Pere Puig.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
