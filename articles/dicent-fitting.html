<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodosetools">
<title>Dicentrics dose-effect fitting • biodosetools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Nunito%20Sans-0.4.0/font.css" rel="stylesheet">
<link href="../deps/_Fira%20Code-0.4.0/font.css" rel="stylesheet">
<link href="../deps/_Nunito-0.4.0/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Dicentrics dose-effect fitting">
<meta property="og:description" content="biodosetools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodosetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Dicentrics</h6>
    <a class="dropdown-item" href="../articles/dicent-fitting.html">Dicentrics dose-effect fitting</a>
    <a class="dropdown-item" href="../articles/dicent-estimation.html">Dicentrics dose estimation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Translocations</h6>
    <a class="dropdown-item" href="../articles/trans-fitting.html">Translocations dose-effect fitting</a>
    <a class="dropdown-item" href="../articles/trans-estimation.html">Translocations dose estimation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biodosetools-team/biodosetools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="dicent-fitting_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Dicentrics dose-effect fitting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biodosetools-team/biodosetools/blob/HEAD/vignettes/dicent-fitting.Rmd" class="external-link"><code>vignettes/dicent-fitting.Rmd</code></a></small>
      <div class="d-none name"><code>dicent-fitting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="input-count-data">Input count data<a class="anchor" aria-label="anchor" href="#input-count-data"></a>
</h2>
<p>The first step is to input the count data. On the  app, we can select to either load the count data from a file (supported formats are <code>.csv</code>, <code>.dat</code>, and <code>.txt</code>) or to input the data manually. Once the table is generated and filled, the “Calculate parameters” button will calculate the number of cells (<span class="math inline">\(N\)</span>), number of aberrations (<span class="math inline">\(X\)</span>), as well as mean (<span class="math inline">\(\bar{y}\)</span>), variance (<span class="math inline">\(\hat{\sigma}^{2}\)</span>), dispersion index (<span class="math inline">\(\hat{\sigma}^{2}/\bar{y}\)</span>), and <span class="math inline">\(u\)</span>-value.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-01.png" alt="'Data input options' and 'Fitting options' boxes in the dose-effect fitting module" width="100%"><p class="caption">
‘Data input options’ and ‘Fitting options’ boxes in the dose-effect fitting module
</p>
</div>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-03.png" alt="'Data input' box in the dose-effect fitting module" width="75%"><p class="caption">
‘Data input’ box in the dose-effect fitting module
</p>
</div>
<p>This step is accomplished in R by calling the <code><a href="../reference/calculate_aberr_table.html">calculate_aberr_table()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"count-data-barquinero-1995.csv"</span>, package <span class="op">=</span> <span class="st">"biodosetools"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_aberr_table.html">calculate_aberr_table</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">count_data</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 13</span></span>
<span class="co">#&gt;        D     N     X    C0    C1    C2    C3    C4    C5    mean     var    DI</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0     <span style="text-decoration: underline;">5</span>000     8  <span style="text-decoration: underline;">4</span>992     8     0     0     0     0 0.001<span style="text-decoration: underline;">6</span>  0.001<span style="text-decoration: underline;">60</span> 0.999</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.1   <span style="text-decoration: underline;">5</span>002    14  <span style="text-decoration: underline;">4</span>988    14     0     0     0     0 0.002<span style="text-decoration: underline;">80</span> 0.002<span style="text-decoration: underline;">79</span> 0.997</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  0.25  <span style="text-decoration: underline;">2</span>008    22  <span style="text-decoration: underline;">1</span>987    20     1     0     0     0 0.011<span style="text-decoration: underline;">0</span>  0.011<span style="text-decoration: underline;">8</span>  1.08 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  0.5   <span style="text-decoration: underline;">2</span>002    55  <span style="text-decoration: underline;">1</span>947    55     0     0     0     0 0.027<span style="text-decoration: underline;">5</span>  0.026<span style="text-decoration: underline;">7</span>  0.973</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  0.75  <span style="text-decoration: underline;">1</span>832   100  <span style="text-decoration: underline;">1</span>736    92     4     0     0     0 0.054<span style="text-decoration: underline;">6</span>  0.056<span style="text-decoration: underline;">0</span>  1.03 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1     <span style="text-decoration: underline;">1</span>168   109  <span style="text-decoration: underline;">1</span>064    99     5     0     0     0 0.093<span style="text-decoration: underline;">3</span>  0.093<span style="text-decoration: underline;">3</span>  0.999</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  1.5    562   100   474    76    12     0     0     0 0.178   0.189   1.06 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2      333   103   251    63    17     2     0     0 0.309   0.353   1.14 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3      193   108   104    72    15     2     0     0 0.560   0.466   0.834</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  4      103   103    35    41    21     4     2     0 1       0.882   0.882</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  5       59   107    11    19    11     9     6     3 1.81    2.09    1.15 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: u &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="irradiation-conditions">Irradiation conditions<a class="anchor" aria-label="anchor" href="#irradiation-conditions"></a>
</h2>
<p>Because irradiation conditions during calibration may influence future dose estimates, and for a better traceability, the user can input the conditions under which the samples used to construct the curve were irradiated. This option is only available in the Shiny app, so that these can be saved into the generated reports.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-02.png" alt="'Irradiation conditions' box in the dose-effect fitting module" width="100%"><p class="caption">
‘Irradiation conditions’ box in the dose-effect fitting module
</p>
</div>
</div>
<div class="section level2">
<h2 id="perform-fitting">Perform fitting<a class="anchor" aria-label="anchor" href="#perform-fitting"></a>
</h2>
<p>To perform the fitting the user needs select the appropriate fitting options to click the “Calculate fitting” button on the “Data input” box.</p>
<p>The fitting results and summary statistics are shown in the “Results” tabbed box, and the dose-effect curve is displayed in the “Curve plot” box.</p>
<p>The “Export results” box shows two buttons: (a) “Save fitting data”, and (b) “Download report”. The “Save fitting data” will generate an <code>.rds</code> file that contains all information about the count data, irradiation conditions, and options selected when performing the fitting. This file can be then loaded in the dose estimation module to load the dose-effect curve coefficients.</p>
<p>Similarly, the “Download report” will generate a <code>.pdf</code> or a <code>.docx</code> report containing all inputs and fitting results.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-dicentrics-fit-04.png" alt="'Results' tabbed box, 'Curve plot' and 'Export results' boxes in the dose-effect fitting module" width="100%"><p class="caption">
‘Results’ tabbed box, ‘Curve plot’ and ‘Export results’ boxes in the dose-effect fitting module
</p>
</div>
<p>To perform the fitting in R we call the <code><a href="../reference/fit.html">fit()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>
  count_data <span class="op">=</span> <span class="va">count_data</span>,
  model_formula <span class="op">=</span> <span class="st">"lin-quad"</span>,
  model_family <span class="op">=</span> <span class="st">"automatic"</span>,
  fit_link <span class="op">=</span> <span class="st">"identity"</span>,
  aberr_module <span class="op">=</span> <span class="st">"dicentrics"</span>
<span class="op">)</span></code></pre></div>
<p>The <code>fit_results</code> object is a list that contains all necessary information about the count data as well as options selected when performing the fitting. This is a vital step to ensure traceability and reproducibility. Below we can see its elements:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_results</span><span class="op">)</span>
<span class="co">#&gt;  [1] "fit_raw_data"         "fit_formula_raw"      "fit_formula_tex"     </span>
<span class="co">#&gt;  [4] "fit_coeffs"           "fit_cor_mat"          "fit_var_cov_mat"     </span>
<span class="co">#&gt;  [7] "fit_dispersion"       "fit_model_statistics" "fit_algorithm"       </span>
<span class="co">#&gt; [10] "fit_model_summary"</span></code></pre></div>
<p>In particular, we can see how <code>fit_coeffs</code> matches the results obtained in the UI:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_results</span><span class="op">$</span><span class="va">fit_coeffs</span>
<span class="co">#&gt;                estimate    std.error statistic      p.value</span>
<span class="co">#&gt; coeff_C     0.001280319 0.0004714055  2.715961 6.608367e-03</span>
<span class="co">#&gt; coeff_alpha 0.021038724 0.0051576170  4.079156 4.519949e-05</span>
<span class="co">#&gt; coeff_beta  0.063032534 0.0040073856 15.729091 9.557291e-56</span></code></pre></div>
<p>To visualise the dose-effect curve, we call the <code><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve</a></span><span class="op">(</span>
  <span class="va">fit_results</span>,
  aberr_name <span class="op">=</span> <span class="st">"Dicentrics"</span>
<span class="op">)</span></code></pre></div>
<p><img src="dicent-fitting_files/figure-html/dic-fit-dose-curve-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://aldomann.com" class="external-link">Alfredo Hernández</a>, David Endesfelder, Pere Puig.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
