<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodosetools">
<title>Translocations dose estimation • biodosetools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Nunito%20Sans-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Fira%20Code-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Nunito-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Translocations dose estimation">
<meta property="og:description" content="biodosetools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodosetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Dicentrics</h6>
    <a class="dropdown-item" href="../articles/dicent-fitting.html">Dicentrics dose-effect fitting</a>
    <a class="dropdown-item" href="../articles/dicent-estimation.html">Dicentrics dose estimation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Translocations</h6>
    <a class="dropdown-item" href="../articles/trans-fitting.html">Translocations dose-effect fitting</a>
    <a class="dropdown-item" href="../articles/trans-estimation.html">Translocations dose estimation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biodosetools-team/biodosetools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="trans-estimation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Translocations dose estimation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biodosetools-team/biodosetools/blob/HEAD/vignettes/trans-estimation.Rmd" class="external-link"><code>vignettes/trans-estimation.Rmd</code></a></small>
      <div class="d-none name"><code>trans-estimation.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="load-pre-calculated-curve">Load pre-calculated curve<a class="anchor" aria-label="anchor" href="#load-pre-calculated-curve"></a>
</h3>
<p>The first step is to either load the pre-calculated curve in <code>.rds</code> format obtained in the dose-effect fitting module or to input the curve coefficients manually. Clicking on “Preview data” will load the curve into the app and display it on the “Results” tabbed box.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-translocations-estimate-01.png" alt="'Curve fitting data options' box and 'Results' tabbed box in the dose estimation module" width="100%"><p class="caption">
‘Curve fitting data options’ box and ‘Results’ tabbed box in the dose estimation module
</p>
</div>
<p>This step is accomplished in R by either using the results from <code><a href="../reference/fit.html">fit()</a></code> or by loading an existing <code>.rds</code> object via <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"translocations-fitting-results.rds"</span>, package <span class="op">=</span> <span class="st">"biodosetools"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_results</span><span class="op">$</span><span class="va">fit_coeffs</span>
<span class="co">#&gt;                estimate   std.error statistic      p.value</span>
<span class="co">#&gt; coeff_C     0.006560406 0.002052834  3.195780 2.538519e-02</span>
<span class="co">#&gt; coeff_alpha 0.027197296 0.009922177  2.741061 5.081502e-02</span>
<span class="co">#&gt; coeff_beta  0.057982322 0.004630926 12.520675 3.100113e-06</span></code></pre></div>
<p>To be able to fit the equivalent full genome case data, we need to calculate the genomic conversion factor.</p>
<p>To do this, in the “Stain color options” box we select the sex of the individual, and the list of chromosomes and stains used for the translocation assay. Clicking on “Generate table” will show a table in the “Chromosome data” box in which we select the chromosome-stain pairs. Clicking on the “Calculate fraction” will calculate the genomic conversion factor.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-translocations-estimate-02.png" alt="'Stains color options', 'Chromosome data' and 'Genomic conversion factor' boxes in the dose estimation module" width="100%"><p class="caption">
‘Stains color options’, ‘Chromosome data’ and ‘Genomic conversion factor’ boxes in the dose estimation module
</p>
</div>
<p>To calculate the genomic conversion factor in R we call the <code><a href="../reference/calculate_genome_factor.html">calculate_genome_factor()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genome_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_genome_factor.html">calculate_genome_factor</a></span><span class="op">(</span>
  dna_table <span class="op">=</span> <span class="va">dna_content_fractions_morton</span>,
  chromosome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Red"</span>, <span class="st">"Red"</span>, <span class="st">"Green"</span>, <span class="st">"Red"</span>, <span class="st">"Green"</span>, <span class="st">"Green"</span><span class="op">)</span>,
  sex <span class="op">=</span> <span class="st">"male"</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genome_factor</span>
<span class="co">#&gt; [1] 0.5847343</span></code></pre></div>
<p>Next we can choose to either load the case data from a file (supported formats are <code>.csv</code>, <code>.dat</code>, and <code>.txt</code>) or to input the data manually. If needed, the user can select to use confounders (either using Sigurdson’s method, or by inputting the translocation frequency per cell). Once the table is generated and filled, the “Calculate parameters” button will calculate the number of cells (<span class="math inline">\(N\)</span>), number of aberrations (<span class="math inline">\(X\)</span>), as well as mean (<span class="math inline">\(\bar{F}_{p}\)</span>), error (<span class="math inline">\(\hat{\sigma}_{p}\)</span>), dispersion index (<span class="math inline">\(\hat{\sigma}^{2}/\bar{y}\)</span>), <span class="math inline">\(u\)</span>-value, expected translocation rate (<span class="math inline">\(X_{c}\)</span>), full genome mean (<span class="math inline">\(\bar{F}_{g}\)</span>), and full genome error (<span class="math inline">\(\hat{\sigma}_{g}\)</span>).</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-translocations-estimate-03.png" alt="'Data input options' and 'Data input' boxes in the dose estimation module" width="100%"><p class="caption">
‘Data input options’ and ‘Data input’ boxes in the dose estimation module
</p>
</div>
<p>This step is accomplished in R by calling the <code><a href="../reference/calculate_aberr_table.html">calculate_aberr_table()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  C0 <span class="op">=</span> <span class="fl">288</span>, C1 <span class="op">=</span> <span class="fl">52</span>, C2 <span class="op">=</span> <span class="fl">9</span>, C3 <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_aberr_table.html">calculate_aberr_table</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"case"</span>,
    assessment_u <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Fp <span class="op">=</span> <span class="va">mean</span>, Fp_err <span class="op">=</span> <span class="va">std_err</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    Xc <span class="op">=</span> <span class="fu"><a href="../reference/calculate_trans_rate_sigurdson.html">calculate_trans_rate_sigurdson</a></span><span class="op">(</span>
      cells <span class="op">=</span> <span class="va">N</span>,
      genome_factor <span class="op">=</span> <span class="va">genome_factor</span>,
      age_value <span class="op">=</span> <span class="fl">30</span>,
      smoker_bool <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>,
    Fg <span class="op">=</span> <span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">Xc</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">genome_factor</span><span class="op">)</span>,
    Fg_err <span class="op">=</span> <span class="va">Fp_err</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">genome_factor</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_data</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 13</span></span>
<span class="co">#&gt;       N     X    C0    C1    C2    C3    Fp Fp_err    DI     u    Xc    Fg</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   350    73   288    52     9     1 0.209 0.025<span style="text-decoration: underline;">9</span>  1.12  1.64  1.02 0.352</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: Fg_err &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="perform-dose-estimation">Perform dose estimation<a class="anchor" aria-label="anchor" href="#perform-dose-estimation"></a>
</h3>
<p>The final step is to select the dose estimation options. In the “Dose estimation options” box we can select type of exposure (acute or protracted), type of assessment (whole-body or partial-body), and error methods for each type of assessment.</p>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-translocations-estimate-04.png" alt="'Dose estimation options' box in the dose estimation module" width="60%"><p class="caption">
‘Dose estimation options’ box in the dose estimation module
</p>
</div>
<div class="figure" style="text-align: center">
<img src="figures/screenshot-translocations-estimate-05.png" alt="'Results' tabbed box, 'Curve plot' and 'Save results' boxes in the dose estimation module" width="100%"><p class="caption">
‘Results’ tabbed box, ‘Curve plot’ and ‘Save results’ boxes in the dose estimation module
</p>
</div>
<p>To perform the dose estimation in R we can call the adequate <code>estimate_*()</code> functions. In this example, we will use <code><a href="../reference/estimate_whole_body_delta.html">estimate_whole_body_delta()</a></code>. First of all, however, we will need to load the fit coefficients and variance-covariance matrix:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_coeffs</span> <span class="op">&lt;-</span> <span class="va">fit_results</span><span class="op">[[</span><span class="st">"fit_coeffs"</span><span class="op">]</span><span class="op">]</span>
<span class="va">fit_var_cov_mat</span> <span class="op">&lt;-</span> <span class="va">fit_results</span><span class="op">[[</span><span class="st">"fit_var_cov_mat"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p>Since we have a protracted exposure, we need to calculate the value of <span class="math inline">\(G(x)\)</span>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">protracted_g_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/protracted_g_function.html">protracted_g_function</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="fl">0.5</span>,
  time_0 <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">protracted_g_value</span>
<span class="co">#&gt; [1] 0.9216251</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_whole_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_whole_body_delta.html">estimate_whole_body_delta</a></span><span class="op">(</span>
  <span class="va">case_data</span>,
  <span class="va">fit_coeffs</span>,
  <span class="va">fit_var_cov_mat</span>,
  conf_int <span class="op">=</span> <span class="fl">0.95</span>,
  <span class="va">protracted_g_value</span>,
  aberr_module <span class="op">=</span> <span class="st">"translocations"</span>
<span class="op">)</span></code></pre></div>
<p>To visualise the estimated doses, we call the <code><a href="../reference/plot_estimated_dose_curve.html">plot_estimated_dose_curve()</a></code> function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_estimated_dose_curve.html">plot_estimated_dose_curve</a></span><span class="op">(</span>
  est_doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whole <span class="op">=</span> <span class="va">results_whole_delta</span><span class="op">)</span>,
  <span class="va">fit_coeffs</span>,
  <span class="va">fit_var_cov_mat</span>,
  <span class="va">protracted_g_value</span>,
  conf_int_curve <span class="op">=</span> <span class="fl">0.95</span>,
  aberr_name <span class="op">=</span> <span class="st">"Translocations"</span>
<span class="op">)</span></code></pre></div>
<p><img src="trans-estimation_files/figure-html/trans-estimated-dose-curve-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://aldomann.com" class="external-link">Alfredo Hernández</a>, David Endesfelder, Pere Puig.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
