<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Translocations dose-effect fitting • biodosetools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Nunito-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Translocations dose-effect fitting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biodosetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Dicentrics</h6></li>
    <li><a class="dropdown-item" href="../articles/dicent-fitting.html">Dicentrics dose-effect fitting</a></li>
    <li><a class="dropdown-item" href="../articles/dicent-estimation.html">Dicentrics dose estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Translocations</h6></li>
    <li><a class="dropdown-item" href="../articles/trans-fitting.html">Translocations dose-effect fitting</a></li>
    <li><a class="dropdown-item" href="../articles/trans-estimation.html">Translocations dose estimation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biodosetools-team/biodosetools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Translocations dose-effect fitting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biodosetools-team/biodosetools/blob/main/vignettes/trans-fitting.Rmd" class="external-link"><code>vignettes/trans-fitting.Rmd</code></a></small>
      <div class="d-none name"><code>trans-fitting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="calculate-genomic-conversion-factor">Calculate genomic conversion factor<a class="anchor" aria-label="anchor" href="#calculate-genomic-conversion-factor"></a>
</h2>
<p>To be able to fit the equivalent full genome dose-effect curve, we
need to calculate the genomic conversion factor.</p>
<p>To do this, in the “Stain color options” box we select the sex of the
individual, and the list of chromosomes and stains used for the
translocation assay. Clicking on “Generate table” will show a table in
the “Chromosome data” box in which we select the chromosome-stain pairs.
Clicking on the “Calculate fraction” will calculate the genomic
conversion factor.</p>
<div class="figure" style="text-align: center">
<img src="figures%2Fscreenshot-translocations-fit-01.png" alt="'Stains color options', 'Chromosome data' and 'Genomic conversion factor' boxes in the dose-effect fitting module." width="100%"><p class="caption">
‘Stains color options’, ‘Chromosome data’ and ‘Genomic conversion
factor’ boxes in the dose-effect fitting module.
</p>
</div>
<p>To calculate the genomic conversion factor in R we call the
<code><a href="../reference/calculate_genome_factor.html">calculate_genome_factor()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genome_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_genome_factor.html">calculate_genome_factor</a></span><span class="op">(</span></span>
<span>  dna_table <span class="op">=</span> <span class="va">dna_content_fractions_morton</span>,</span>
<span>  chromosome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Red"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="st">"female"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genome_factor</span></span>
<span><span class="co">#&gt; [1] 0.3147797</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-count-data">Input count data<a class="anchor" aria-label="anchor" href="#input-count-data"></a>
</h2>
<p>Once the genomic conversion factor has been calculated, we can input
the count data. On the {shiny} app, we can select to either load the
count data from a file (supported formats are <code>.csv</code>,
<code>.dat</code>, and <code>.txt</code>) or to input the data manually.
Once the table is generated and filled, the “Calculate parameters”
button will calculate the total number of cells
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>),
total number of aberrations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>),
as well as mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>y</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{y}</annotation></semantics></math>),
variance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^{2}</annotation></semantics></math>),
dispersion index
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>/</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\sigma^{2}/\bar{y}</annotation></semantics></math>),
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>-value.</p>
<div class="figure" style="text-align: center">
<img src="figures%2Fscreenshot-translocations-fit-02.png" alt="'Data input options' and 'Fitting options' boxes in the dose-effect fitting module." width="100%"><p class="caption">
‘Data input options’ and ‘Fitting options’ boxes in the dose-effect
fitting module.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="figures%2Fscreenshot-translocations-fit-03.png" alt="'Data input' box in the dose-effect fitting module." width="75%"><p class="caption">
‘Data input’ box in the dose-effect fitting module.
</p>
</div>
<p>This step is accomplished in R by calling the
<code><a href="../reference/calculate_aberr_table.html">calculate_aberr_table()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"count-data-rodriguez-2004.csv"</span>, package <span class="op">=</span> <span class="st">"biodosetools"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate_aberr_table.html">calculate_aberr_table</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span> <span class="op">*</span> <span class="va">genome_factor</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 13</span></span></span>
<span><span class="co">#&gt;        D     N     X    C0    C1    C2    C3    C4    C5    mean     var    DI</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0    <span style="text-decoration: underline;">1</span>371.     6  <span style="text-decoration: underline;">4</span>350     6     0     0     0     0 0.001<span style="text-decoration: underline;">38</span> 0.001<span style="text-decoration: underline;">38</span> 0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.1  <span style="text-decoration: underline;">1</span>046.    15  <span style="text-decoration: underline;">3</span>309    15     0     0     0     0 0.004<span style="text-decoration: underline;">51</span> 0.004<span style="text-decoration: underline;">49</span> 0.996</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  0.25  966.    18  <span style="text-decoration: underline;">3</span>051    18     0     0     0     0 0.005<span style="text-decoration: underline;">87</span> 0.005<span style="text-decoration: underline;">83</span> 0.994</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  0.5   967.    33  <span style="text-decoration: underline;">3</span>039    33     0     0     0     0 0.010<span style="text-decoration: underline;">7</span>  0.010<span style="text-decoration: underline;">6</span>  0.990</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  0.75  664.    40  <span style="text-decoration: underline;">2</span>072    38     1     0     0     0 0.018<span style="text-decoration: underline;">9</span>  0.019<span style="text-decoration: underline;">5</span>  1.03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1     669.    50  <span style="text-decoration: underline;">2</span>075    48     1     0     0     0 0.023<span style="text-decoration: underline;">5</span>  0.023<span style="text-decoration: underline;">9</span>  1.02 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  1.5   328.    56   990    50     3     0     0     0 0.053<span style="text-decoration: underline;">7</span>  0.056<span style="text-decoration: underline;">6</span>  1.05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2     226.    71   650    65     3     0     0     0 0.098<span style="text-decoration: underline;">9</span>  0.097<span style="text-decoration: underline;">6</span>  0.987</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3     246.   157   649   108    23     1     0     0 0.201   0.227   1.13 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  4     125.   147   265   117    15     0     0     0 0.370   0.310   0.836</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  5     124.   180   246   122    23     4     0     0 0.456   0.426   0.936</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: u &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="perform-fitting">Perform fitting<a class="anchor" aria-label="anchor" href="#perform-fitting"></a>
</h2>
<p>To perform the fitting the user needs to select the appropriate
fitting options to click the “Calculate fitting” button on the “Data
input” box. The fit can be done either using the full genome
translocations, or those measured by FISH. This will not impact any
future dose estimation, as the results internally use the full genome
translocations.</p>
<p>The fitting results and summary statistics are shown in the “Results”
tabbed box, and the dose-effect curve is displayed in the “Curve plot”
box.</p>
<p>The “Export results” box shows two buttons: (a) “Save fitting data”,
and (b) “Download report”. The “Save fitting data” will generate an
<code>.rds</code> file that contains all information about the count
data, irradiation conditions, and options selected when performing the
fitting. This file can be then loaded in the dose estimation module to
load the dose-effect curve coefficients.</p>
<p>Similarly, the “Download report” will generate a <code>.pdf</code> or
a <code>.docx</code> report containing all inputs and fitting
results.</p>
<div class="figure" style="text-align: center">
<img src="figures%2Fscreenshot-translocations-fit-04.png" alt="'Results' tabbed box, 'Curve plot' and 'Export results' boxes in the dose-effect fitting module." width="100%"><p class="caption">
‘Results’ tabbed box, ‘Curve plot’ and ‘Export results’ boxes in the
dose-effect fitting module.
</p>
</div>
<p>To perform the fitting in R we call the <code><a href="../reference/fit.html">fit()</a></code>
function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span></span>
<span>  count_data <span class="op">=</span> <span class="va">count_data</span>,</span>
<span>  model_formula <span class="op">=</span> <span class="st">"lin-quad"</span>,</span>
<span>  model_family <span class="op">=</span> <span class="st">"automatic"</span>,</span>
<span>  fit_link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  aberr_module <span class="op">=</span> <span class="st">"translocations"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>fit_results</code> object is a list that contains all
necessary information about the count data as well as options selected
when performing the fitting. This is a vital step to ensure traceability
and reproducibility. Below we can see its elements:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_results</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "fit_raw_data"         "fit_formula_raw"      "fit_formula_tex"     </span></span>
<span><span class="co">#&gt;  [4] "fit_coeffs"           "fit_cor_mat"          "fit_var_cov_mat"     </span></span>
<span><span class="co">#&gt;  [7] "fit_dispersion"       "fit_model_statistics" "fit_algorithm"       </span></span>
<span><span class="co">#&gt; [10] "fit_model_summary"</span></span></code></pre></div>
<p>In particular, we can see how <code>fit_coeffs</code> matches the
results obtained in the UI:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_results</span><span class="op">$</span><span class="va">fit_coeffs</span></span>
<span><span class="co">#&gt;                estimate   std.error statistic      p.value</span></span>
<span><span class="co">#&gt; coeff_C     0.006560406 0.002052834  3.195780 2.538519e-02</span></span>
<span><span class="co">#&gt; coeff_alpha 0.027197296 0.009922177  2.741061 5.081502e-02</span></span>
<span><span class="co">#&gt; coeff_beta  0.057982322 0.004630926 12.520675 3.100113e-06</span></span></code></pre></div>
<p>To visualise the dose-effect curve, we call the
<code><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fit_dose_curve.html">plot_fit_dose_curve</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_results</span>,</span>
<span>  aberr_name <span class="op">=</span> <span class="st">"Translocations"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="trans-fitting_files/figure-html/trans-fit-dose-curve-1.png" alt="Plot of dose-effect curve generated by \{biodosetools\}. The grey shading indicates the uncertainties associated with the calibration curve." width="576"><p class="caption">
Plot of dose-effect curve generated by {biodosetools}. The grey shading
indicates the uncertainties associated with the calibration curve.
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://aldomann.com" class="external-link">Alfredo Hernández</a>, David Endesfelder, Pere Puig.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
